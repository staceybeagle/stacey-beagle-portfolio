var Layout={layoutStyle:"left",body:$("body"),bodyWidth:$("body").width(),boxResult:$(".result"),boxes:$(".boxes"),topBoxesCon:$(".top-boxes"),headerHeight:$("#main-header").outerHeight(),noLineNums:$("body").hasClass("no-line-numbers"),resizer:$("#resizer"),resizerWidth:$("#resizer").width(),dragCover:$("#editor-drag-cover"),widthReadout:$("#width-readout"),heightOfEditorHeader:$(".powers").outerHeight(),editorResizers:$(".editor-resizer"),$mainHeader:$(".main-header"),$siteFooter:$(".site-footer"),windowResizeTimer:0,init:function(){this.pageType=__pageType,this.layoutStyle="right"===$.cookie("__cp_layout")?"right":"left",this._bindToHub(),this.initLayout(),this.setUpEditorResizers(),this.heightSubstract=this._calcHeightSubtract()},setUpCodeEditorHeights:function(){$(".code-wrap").each(function(){var t=$(this),e=t.closest(".box").height()-Layout.heightOfEditorHeader;t.height(e)})},setUpEditorResizers:function(){Layout.editorResizers.draggable({start:function(){Layout.topBoxesCon.addClass("editor-is-resizing"),Layout.origCSSEditorHeight=$("#box-css").height(),Layout.origHTMLEditorHeight=$("#box-html").height()},stop:function(){Layout.topBoxesCon.removeClass("editor-is-resizing"),Layout.setUpCodeEditorHeights(),Hub.pub("editor-refresh",{delay:200})},axis:"y",drag:function(t,e){"editor-resizer-html"===e.helper[0].id?$("#box-html").css("flex","0 1 "+(e.offset.top-Layout.headerHeight)+"px"):$("#box-css").css("flex","0 1 "+(Layout.origCSSEditorHeight+e.position.top)+"px")},containment:Layout.boxes})},_bindToHub:function(){Hub.sub("server-ui-change",$.proxy(this._onUIChange,this))},_onUIChange:function(t,e){if(e.ui&&e.ui.layout&&this.layoutStyle!==e.ui.layout){var o=$("#"+e.ui.layout+"-layout").attr("href");document.location=o}},_calcHeightSubtract:function(){return"pres"===this.pageType?this.$siteFooter.outerHeight()-1:this.$mainHeader.outerHeight()+this.$siteFooter.outerHeight()},initLayout:function(){Layout.resizer.draggable({start:function(){Layout.dragCover.show(),Layout.widthReadout.addClass("visible")},stop:function(t,e){Layout.stopDragging(t,e),Layout.widthReadout.removeClass("visible")},axis:"x",drag:function(t,e){"right"===Layout.layoutStyle?(Layout.topBoxesCon.width(Layout.bodyWidth-e.offset.left),Layout.widthReadout.text(Math.round(e.offset.left-14)+"px")):(Layout.topBoxesCon.width(e.offset.left),Layout.widthReadout.text(Math.round(Layout.bodyWidth-e.offset.left)-14+"px"))},containment:$(".page-wrap")})},stopDragging:function(){Layout.dragCover.hide(),"function"==typeof Comment.tweakCommentsSize&&Comment.tweakCommentsSize(),Hub.pub("editor-refresh",{delay:0})},doneLoading:function(){Layout.body.removeClass("prelayout"),$(window).load(function(){Layout.body.removeClass("preload")}).resize(function(){Layout.boxes.height(Layout.body.height()-Layout.heightSubstract),Layout.setUpEditorResizers(),clearTimeout(Layout.windowResizeTimer),Layout.topBoxesCon.addClass("editor-is-resizing"),Layout.windowResizeTimer=setTimeout(function(){Layout.setUpCodeEditorHeights(),Layout.topBoxesCon.removeClass("editor-is-resizing"),Layout.bodyWidth=$("body").width()},600)}).resize(),Layout.resizer.trigger("drag"),Layout.setUpCodeEditorHeights()}};Layout.init();